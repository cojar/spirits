<!DOCTYPE html>
<html lang="ko" layout:decorate="~{layout}" xmlns:th="http://www.w3.org/1999/xhtml"
      xmlns:layout="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>보드카 리스트 페이지</title>
    <link rel="stylesheet" type="text/css" th:href="@{/vodka_list_style.css}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>
<body>
<div layout:fragment="content">
    <div class="wrap">

        <!--개별리스트 목록-->
        <div class="information-box">
            <div class="title">
                <h2>보드카</h2>
            </div>
            <div class="text">
                클래식한 투명한 술로, 보드카는 중성적이고 깔끔한 맛을 가진 독특한 알코올 음료입니다.
            </div>
            <div class="img-box">
                <img src="https://blog.kakaocdn.net/dn/cQSygf/btqC5nYOLQO/7JZPafuCyUD2A4q6NSjZYK/img.jpg" alt="">
            </div>
        </div>
        <!--드롭다운메뉴 시작-->
        <div class="drop-down-box">
            <!-- 서브카테고리(중분류) 드롭다운 메뉴 -->
            <div class="SubCategory-box">
                <label for="SubCategory"></label>
                <select id="SubCategory" onchange="filterBySubcategory()">
                    <option value="">중분류 전체</option>
                    <option th:each="subCategory : ${subCategoryList}"
                            th:value="${subCategory.id}" th:text="${subCategory.subCategory}"></option>
                </select>
            </div>

            <!-- 가격범위 드롭다운 메뉴 -->
            <div class="Costrange-box">
                <label for="Costrange"></label>
                <select id="Costrange" onchange="filterByCostrange()">
                    <option value="가격">가격범위 전체</option>
                    <option th:each="costRange : ${costRangeList}"
                            th:value="${costRange.id}" th:text="${costRange.costRange}"></option>
                </select>
            </div>

            <!-- 알콜도수범위 드롭다운 메뉴 -->
            <div class="ABVrange-box">
                <label for="ABVrange"></label>
                <select id="ABVrange" onchange="filterByABVrange()">
                    <option value="도수">도수범위 전체</option>
                    <option th:each="aBVrange : ${abVrangeList}"
                            th:value="${aBVrange.id}" th:text="${aBVrange.abvRange}"></option>
                </select>
            </div>

            <!-- 용량 드롭다운 메뉴 -->
            <div class="NetWeight-box">
                <label for="NetWeight"></label>
                <select id="NetWeight" onchange="filterByNetWeight()">
                    <option value="용량">용량범위 전체</option>
                    <option th:each="netWeight : ${netWeightList}"
                            th:value="${netWeight.id}" th:text="${netWeight.netWeight}"></option>
                </select>
            </div>

            <!-- 안주 드롭다운 메뉴 -->
            <div class="paring-box">
                <label for="Paring"></label>
                <select id="Paring" onchange="filterByParing()">
                    <option value="안주">안주범위 전체</option>
                    <option th:each="pairing : ${pairingList}"
                            th:value="${pairing.id}" th:text="${pairing.pairing}"></option>
                </select>
            </div>

            <!-- 오크통(캐스크) 드롭다운 메뉴 -->
            <div class="Cask-box">
                <label for="Cask"></label>
                <select id="Cask" onchange="filterByCask()">
                    <option value="오크통">오크통범위 전체</option>
                    <option th:each="cask : ${caskList}" th:value="${cask.id}" th:text="${cask.cask}"></option>
                </select>
            </div>


            <!-- 국가 드롭다운 메뉴 -->
            <div class="Nation">
                <label for="Nation"></label>
                <select id="Nation" onchange="filterByNation()">
                    <option value="국가">국가범위 전체</option>
                    <option th:each="nation : ${nationList}"
                            th:value="${nation.id}" th:text="${nation.nation}"></option>
                </select>
            </div>
        </div>
        <!--개별리스트 목록 끝-->

        <div class="section">
            <div class="search-box">
                <div class="search-result" th:text="${productList.size()}" style="display : inline-block;"></div>
                건의 결과가 있어요
            </div>

            <section class="goods-list-section">
                <div class="goods-list">
                    <div class="goods-1" th:each="product : ${productList}">
                        <a th:href="@{|/product/detail/${product.id}|}">
                            <img src="https://img-cf.kurly.com/cdn-cgi/image/width=400,format=auto/shop/data/goods/1645598047189l0.jpg"
                                 alt="">
                            <p class="goods-name" th:text="${product.name}"
                               style="font-weight : bold; font-size : 2rem;"></p>
                            <p><span th:text="${product.cost}"></span>원</p>
                        </a>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>
<!--스크립트 들어가는 자리-->
<script layout:fragment="script" type='text/javascript'>
    // Ajax 요청을 통해 필터링된 결과를 받아서 리스팅하는 함수
    function updateProductList(filteredProductList) {
        var goodsListSection = $('.goods-list-section');
        goodsListSection.empty();  // 기존 상품 목록 비우기

        // 필터링된 상품 목록 추가
        filteredProductList.forEach(function (product) {
            var goods = $('<div class="goods-1"></div>');

            var link = $('<a></a>').attr('href', '/product/detail/' + product.id);
            var img = $('<img>').attr('src', 'https://img-cf.kurly.com/cdn-cgi/image/width=400,format=auto/shop/data/goods/1645598047189l0.jpg').attr('alt', '');
            var name = $('<p class="goods-name"></p>').text(product.name).css({'font-weight': 'bold', 'font-size': '2rem'});
            var cost = $('<p></p>').text(product.cost + '원');

            link.append(img, name, cost);
            goods.append(link);
            goodsListSection.append(goods);
        });
    }

    // 중분류로 필터링
    function filterBySubcategory() {
        var selectedSubcategories = $('#SubCategory').val();  // 선택된 중분류 목록

        // Ajax 요청
        $.ajax({
            url: '/product/list/Whiskey',
            url: '/product/list/Vodka',
            url: '/product/list/Tequila',
            url: '/product/list/Gin',
            url: '/product/list/Rum',
            url: '/product/list/Brandy',
            url: '/product/list/Beer',
            type: 'GET',
            data: {subCategoryId: selectedSubcategories},
            success: function (response) {
                updateProductList(response.productList);
            },
            error: function (error) {
                console.log(error);
            }
        });
    }

    // 가격범위로 필터링
    function filterByCostrange() {
        var selectedCostrange = $('#Costrange').val();  // 선택된 가격범위

        // Ajax 요청
        $.ajax({
            url: '/product/list/Whiskey',
            url: '/product/list/Vodka',
            url: '/product/list/Tequila',
            url: '/product/list/Gin',
            url: '/product/list/Rum',
            url: '/product/list/Brandy',
            url: '/product/list/Beer',
            type: 'GET',
            data: {costRangeId: selectedCostrange},
            success: function (response) {
                console.log(response);
                updateProductList(response.productList);
            },
            error: function (error) {
                console.log(error);
            }
        });
    }

    // 도수범위로 필터링 (filterByABVrange() 함수와 같은 방식으로 구현)

    // 용량범위로 필터링 (filterByNetWeight() 함수와 같은 방식으로 구현)

    // 안주범위로 필터링 (filterByParing() 함수와 같은 방식으로 구현)

    // 오크통범위로 필터링 (filterByCaskBox() 함수와 같은 방식으로 구현)

    // 국가범위로 필터링 (filterByNation() 함수와 같은 방식으로 구현)








</script>
</body>
</html>